<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥šå¿—å¤å­¦æœ¯ä¸»é¡µ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“Š</text></svg>">
    <style>
        /* é‡å®šå‘é¡µé¢çš„ç®€å•æ ·å¼ */
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            display: none; /* é»˜è®¤éšè—ï¼Œé¿å…é—ªçƒ */
        }
        .redirect-notice {
            max-width: 600px;
            margin: 50px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .manual-link {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background 0.3s;
        }
        .manual-link:hover {
            background: #0056b3;
        }
        .cancel-link {
            background: #6c757d;
        }
        .cancel-link:hover {
            background: #545b62;
        }
    </style>
</head>
<body>
    <div class="redirect-notice">
        <h2>ğŸš€ æ™ºèƒ½é‡å®šå‘</h2>
        <p id="redirect-message">
            <span class="loading"></span>
            æ­£åœ¨ä¸ºæ‚¨é€‰æ‹©æœ€ä½³è®¿é—®ä½“éªŒ...
        </p>
        <div id="manual-options" style="display: none;">
            <p>æ‚¨å¯ä»¥æ‰‹åŠ¨é€‰æ‹©ï¼š</p>
            <a href="https://zedxzk-github-io.vercel.app/" class="manual-link">è®¿é—® Vercel ç‰ˆæœ¬ï¼ˆæ¨èï¼‰</a>
            <a href="javascript:loadCurrentSite()" class="manual-link cancel-link">ç»§ç»­å½“å‰ç‰ˆæœ¬</a>
        </div>
    </div>

    <!-- å®é™…çš„é¡µé¢å†…å®¹ï¼ˆå½“ç”¨æˆ·é€‰æ‹©ç•™åœ¨ GitHub Pages æ—¶æ˜¾ç¤ºï¼‰ -->
    <div id="main-content" style="display: none;">
        <!-- è¿™é‡Œä¼šåŠ è½½åŸå§‹çš„ index.html å†…å®¹ -->
    </div>

    <script>
        // æ™ºèƒ½é‡å®šå‘é€»è¾‘
        function smartRedirect() {
            const hostname = window.location.hostname;
            const isGitHubPages = hostname.includes('github.io');
            const isVercel = hostname.includes('vercel.app') || hostname.includes('vercel.dev');
            
            // å¦‚æœä¸åœ¨ GitHub Pagesï¼Œç›´æ¥æ˜¾ç¤ºå†…å®¹
            if (!isGitHubPages) {
                loadCurrentSite();
                return;
            }
            
            // æ£€æŸ¥ç”¨æˆ·åå¥½
            const userPreference = localStorage.getItem('site_preference');
            const lastChoiceTime = localStorage.getItem('preference_time');
            const now = Date.now();
            const oneWeek = 7 * 24 * 60 * 60 * 1000;
            
            // å¦‚æœç”¨æˆ·æœ€è¿‘é€‰æ‹©äº† GitHub Pagesï¼Œç›´æ¥åŠ è½½
            if (userPreference === 'github' && lastChoiceTime && (now - lastChoiceTime) < oneWeek) {
                loadCurrentSite();
                return;
            }
            
            // å¦‚æœç”¨æˆ·é€‰æ‹©äº† Vercel æˆ–è€…æ˜¯é¦–æ¬¡è®¿é—®ï¼Œæ˜¾ç¤ºé‡å®šå‘
            document.body.style.display = 'block';
            
            // å»¶è¿Ÿ3ç§’åè‡ªåŠ¨è·³è½¬åˆ° Vercel
            setTimeout(() => {
                document.getElementById('redirect-message').innerHTML = 
                    '<span class="loading"></span>3ç§’åè·³è½¬åˆ°åŠŸèƒ½å®Œæ•´çš„ Vercel ç‰ˆæœ¬...';
                
                // æ˜¾ç¤ºæ‰‹åŠ¨é€‰æ‹©é€‰é¡¹
                document.getElementById('manual-options').style.display = 'block';
                
                // å¼€å§‹å€’è®¡æ—¶
                let countdown = 3;
                const timer = setInterval(() => {
                    countdown--;
                    if (countdown > 0) {
                        document.getElementById('redirect-message').innerHTML = 
                            `<span class="loading"></span>${countdown}ç§’åè·³è½¬åˆ°åŠŸèƒ½å®Œæ•´çš„ Vercel ç‰ˆæœ¬...`;
                    } else {
                        clearInterval(timer);
                        // ä¿å­˜ç”¨æˆ·åå¥½ï¼ˆé»˜è®¤é€‰æ‹©ï¼‰
                        localStorage.setItem('site_preference', 'vercel');
                        localStorage.setItem('preference_time', now);
                        window.location.href = 'https://zedxzk-github-io.vercel.app/';
                    }
                }, 1000);
                
                // ä¿å­˜å®šæ—¶å™¨å¼•ç”¨ä»¥ä¾¿å–æ¶ˆ
                window.redirectTimer = timer;
            }, 1000);
        }
        
        function loadCurrentSite() {
            // å–æ¶ˆé‡å®šå‘å®šæ—¶å™¨
            if (window.redirectTimer) {
                clearInterval(window.redirectTimer);
            }
            
            // ä¿å­˜ç”¨æˆ·åå¥½
            localStorage.setItem('site_preference', 'github');
            localStorage.setItem('preference_time', Date.now());
            
            // åŠ è½½å®é™…å†…å®¹
            fetch('/index.html')
                .then(response => response.text())
                .then(html => {
                    // æ›¿æ¢å½“å‰é¡µé¢å†…å®¹
                    document.documentElement.innerHTML = html;
                })
                .catch(error => {
                    // å¦‚æœåŠ è½½å¤±è´¥ï¼Œç›´æ¥é‡å®šå‘åˆ° index.html
                    window.location.href = '/index.html';
                });
        }
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
        window.addEventListener('load', smartRedirect);
    </script>
</body>
</html>
