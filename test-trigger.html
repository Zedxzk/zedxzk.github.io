<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>è®¿é—®è®¡æ•°å™¨æµ‹è¯•</title>
</head>
<body>
    <h1>è®¿é—®è®¡æ•°å™¨æµ‹è¯•é¡µé¢</h1>
    
    <div>
        <h2>ç¬¬ä¸€æ­¥ï¼šè®¾ç½®GitHub PAT Token</h2>
        <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
        <pre>localStorage.setItem("gh_action_trigger_token", "your_github_pat_token_here");</pre>
        
        <h2>ç¬¬äºŒæ­¥ï¼šæµ‹è¯•è§¦å‘</h2>
        <button onclick="testTrigger()">æµ‹è¯•GitHub Actionè§¦å‘</button>
        
        <h2>ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æ—¥å¿—</h2>
        <p>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ä¿¡æ¯</p>
    </div>

    <script>
        function testTrigger() {
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•GitHub Actionè§¦å‘...');
            
            try {
                const token = localStorage.getItem('gh_action_trigger_token');
                if (!token) {
                    console.error('âŒ æœªæ‰¾åˆ°tokenï¼Œè¯·å…ˆè®¾ç½®ï¼š');
                    console.log('localStorage.setItem("gh_action_trigger_token", "your_token_here");');
                    return;
                }
                
                console.log('âœ… Tokenå·²è®¾ç½®ï¼Œå‡†å¤‡è§¦å‘...');
                
                // åˆ›å»ºæµ‹è¯•æ•°æ®
                const testData = {
                    total_visits: 999,
                    today_visits: 1,
                    last_updated: new Date().toISOString().split('T')[0],
                    daily_stats: {}
                };
                
                // è§¦å‘GitHub Action
                fetch('https://api.github.com/repos/Zedxzk/zedxzk.github.io/dispatches', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'token ' + token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        event_type: 'update_visitor_count',
                        client_payload: {
                            ...testData,
                            trigger_time: new Date().toISOString(),
                            user_agent: navigator.userAgent,
                            referrer: 'test-page'
                        }
                    })
                }).then(response => {
                    console.log('ğŸ“¡ å“åº”çŠ¶æ€:', response.status);
                    if (response.status === 204) {
                        console.log('âœ… GitHub Actionè§¦å‘æˆåŠŸï¼');
                        console.log('ğŸ”„ è¯·æ£€æŸ¥GitHub Actionsé¡µé¢ç¡®è®¤workflowè¿è¡Œ');
                    } else {
                        console.error('âŒ è§¦å‘å¤±è´¥ï¼ŒçŠ¶æ€ç :', response.status);
                    }
                }).catch(error => {
                    console.error('âŒ ç½‘ç»œé”™è¯¯:', error);
                });
                
            } catch (error) {
                console.error('âŒ æµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥tokençŠ¶æ€
        window.onload = function() {
            const token = localStorage.getItem('gh_action_trigger_token');
            if (token) {
                console.log('âœ… GitHub PAT Tokenå·²è®¾ç½®');
                console.log('Tokenå‰ç¼€:', token.substring(0, 8) + '...');
            } else {
                console.log('âš ï¸ æœªè®¾ç½®GitHub PAT Token');
            }
        };
    </script>
</body>
</html>
